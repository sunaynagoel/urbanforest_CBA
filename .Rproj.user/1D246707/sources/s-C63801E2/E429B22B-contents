---
title: "Cost-Benefit Analysis of Urban Forest"
output: 
  flexdashboard::flex_dashboard:
    storyboard: true
    social: menu
    source: embed
    runtime: shiny
---

```{r }
#message=FALSE, warning=FALSE, include=FALSE, echo=FALSE
# install packages and library

# install.packages("leaflet")
#install.packages("flexdashboard")
#install.packages("shiny")
#install.packages("here")
#install.packages("dplyr")
#install.packages ("kableExtra")

library(shiny)
library(flexdashboard)
library(leaflet)
library(here)
library(dplyr)
library(kableExtra)
```


```{r global, include=FALSE}

# message=FALSE, warning=FALSE, include=FALSE, echo=FALSE
# load data 
dat <- read.csv(here("data/trees-cost-benefit.csv"))
dat.cost.correct <- read.csv(here("data/costdetails_correct.csv"))
dat.cost.convenient <- read.csv(here("data/costdetails_convenient.csv"))

```

<style type="text/css"> .sidebar { overflow: auto; } </style>

Introduction {data-orientation=columns}
=========================================
 
Column {.sidebar data-width=300}
-----------------------------------------------------------------------
 
 
### Cost Benefit Analysis of developing Urban Forest in Phoenix, AZ. 

**Location**: Phoenix, AZ -- State Capital of Arizoan and Fifth most populous ciy in the United States.    
**Objectives**: Increase the Urban forest to offset the Carbon-Di-Oxide (CO2) generated by air travel by providing Cost-Beneefit analysis of five most comman urban tree species in the area.    
**Data Used**: Cost and Benefit of each of those species for a span 30 years.    
**Process**: Investigate the number of trees needed to offest the CO2 generated by a flight. Then navigate through details of cost and benefit provided by these trees while presenting the user with Net Present Value of the tree investement. 


Column 
----------------------------------


### Phoenix 

```{r}
fillRow( 
        
leaflet() %>%
  addTiles(options = providerTileOptions(minZoom = 8, maxZoom = 10)) %>%
  addMarkers(lng=-112.0740, lat=33.4484, popup="City Center Phoenix, AZ")

)
```

Analysis {data-orientation=columns}
=========================================

Column {.sidebar data-width=600}
-----------------------------------------------------------------------

### Carbon generated by flights and Trees needed to offset that carbon

**Six hours flight** (cross country flight) generates approximately **3700 lbs of carbon** in a round trip.     
**Three hours flight** (Same sector flight) generates approximately **1270 lbs of carbon** in a round trip.      
**Two hour flight** (same sector shorter flight) generates approximately **950 lbs of carbon** in a round trip.    
**One hour flight** generates approximately **380 lbs of carbon** in a round trip.    
The carbon is calculated for a **single passenger in economy class**.   

```{r}

selectInput("lbs_carbon", label = "Carbon generated by a round trip airtravel:",
            choices = c(3700, 1270, 950,380), selected = 3700)

selectInput("species_trees", label = "Type of the tree to be planted:",
            choices = c("mesquite", "blue palo verde", "aleppo pine", "palo brea", "chinese elm"), selected = "mesquite")
```

Column 
----------------------------------

### Amount of carbon reduced per tree and number of trees needed to offset it
```{r}
#colnames(dat)

# use the user input of trees to filter data
# cant get input$species_trees to work. trying codes with mesquite
input.dat <- dat  %>% 
  filter (species %in% "mesquite")

# filter type convenient 
convenient.dat <-input.dat %>% 
  filter (correct_vs_convenient == "convenient") 
# calculate the carbon reduced by one tree by convenient installation 
carbon_convenient <- sum(convenient.dat$co2reduction_lb)
carbon_convenient
# number of trees needed to offset carbon 
# can't get input$lbs_carbon to work 
n_tree_convenient <- round ( 3700/carbon_convenient)
n_tree_convenient

# filter type correct 
correct.dat <- input.dat %>% 
  filter (correct_vs_convenient == "correct") 
# calculate the carbon reduced by one tree by convenient installation 
carbon_correct <- sum(correct.dat$co2reduction_lb)
carbon_correct
# can't get input$lbs_carbon to work 
n_tree_correct <- round ( 3700/carbon_correct)
n_tree_correct

# give some details about the tree or link to a webpage connecting to that tree details

```
*** 
Some detail about the tree or an external link to another website with tree characteristic 


Cost and Benefit {.storyboard}
=========================================

### Urban Tree Installtion 

Urban trees face special challenges with soil quality and root space. Two methods of installing urban trees are covered under this study - **Correct Method** and **Convenient Method**.     

The *correct method* of installing tree may be expensive but it *increases the lifespan* of trees and the *overall benefit* derived from them. Since the trees installed using this method have higher life span, the cost associated with replacing trees is very minimal as well.     
These are the **ten steps** of *planting a mature tree correctly* in urban area (McDonagh,2015):     
1.	Calculate and create a soil volume under paving (sidewalks, plazas, parking lots, etc.) of at least 1,000 cubic feet per tree.  
2.	Create, at minimum, a 5′ x 5′ tree pit openings to allow for adequate trunk flare.   
3.	Slope concrete sidewalk to direct stormwater into tree pit openings.   
4.	Select 5cm (2”) caliper balled-and-burlapped trees with strong central leaders and side-branches uniformly spaced above 1.8m (6’), all branches no more than half the diameter of the main tree-trunk at that branch/trunk junction.    
5.	Place the root package in the ground, removing ropes, strings, burlap and wire basket two-thirds the way down the root ball.   
6.	Find original nursery soil line in the root ball with a surveyor’s pin or landscape spike. This is excess soil, remove it. This original soil line is now the finished top elevation of the root ball.     
7.	Locate, cut and remove any girdling (adventitious) roots on the trunk above the original nursery soil line.    
8.	Backfill loam around the outside perimeter of the root ball and eliminate any air pockets, do not place additional soil above the old nursery soil line on top of the root ball.    
9.	Place wood chip mulch on root ball similar to a saucer: no chips against the trunk; 2” (5 cm) deep on top of the root ball and 10cm (4”) deep at the perimeter.    
10.	Water in root ball thoroughly at planting, and several more times during that growing season.  

Following these ten steps, the *proper installation cost* of a matured tree comes to **$16,341/tree**.

Trees can be planted following **convenient method**, where preparation work is minimal. According to this method (64 ft3 of loam per tree) the installation cost is kept down, but research shows that trees planted with method *need replacing three times throughout their lives*. The insatllation cost included *transport, site preparation and clean up, equipment, and miscellaneous supplies*. The estimates are based on [howmuch.net](https://howmuch.net/costs/tree-install).   
Following the *convenient method* the installation cost comes to :    

For *large tree (14ft- 20ft)* is **$2420/tree**  
For *medium tree (8ft-10ft)* is **$255/tree**  
For *small tree (4ft-6ft)* is **$105/tree**


### Cost of planting and maintaining trees {data-commentary-width=500}

```{r}
# Correct Installtion 
# make a table showing cost in half of story board


  kable(dat.cost.correct) %>%
  kable_styling(bootstrap_options = c("striped", "hover", "condensed", "responsive"), full_width = F, position = "left")
 
# convenient Installtion 
# make a table SHowing cost in half of story board 

  kable(dat.cost.convenient) %>%
  kable_styling(bootstrap_options = c("striped", "hover", "condensed", "responsive"), full_width = F, position = "left")

```

*** 
Explaination of cost

### Benefits from the tree

```{r}
# make a graph showing benefit of correct planting the chosen tree /year for 30 years (1 tree)

# make a graph showing benefit of convenient planting the chosen tree /year for 30 years (1 tree)


```

*** 

Details of benefit 



### Net present Value of Cost Benefit analysis 

```{r}
# NPV from the tree installtion and explaination in case of correct and convenient installtion
```

***
How is NPV Calculated 


About {.storyboard}
=========================================

### About the Developer 


### Documentation 
